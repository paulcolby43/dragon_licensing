apiVersion: '2021-10-01'
name: tranact-prod-licensing-containers
location: eastus
tags: { CreatedBy: Scrap Dragon, Environment: Production, OpsTeam: Scrap Dragon, Workload: Scrap Dragon }
properties:
  osType: Linux
  containers:
  - name: web
    properties:
      image: tranact/licensing_web_app:production
      ports:
        - port: 3000
      resources:
        requests:
          cpu: 1.0
          memoryInGB: 2
      environmentVariables:
        - name: LICENSING_HOST
          value: trazurelicenses.database.windows.net
        - name: LICENSING_DATABASE
          value: SDLicenseServer
        - name: LICENSING_USERNAME
          value: superadmin
        - name: LICENSING_PASSWORD
          value: "zY8ebjr1eEbsnm83zB2g"
        - name: TRANACT_LICENSING_HOST
          value: trazurelicenses.database.windows.net
        - name: TRANACT_LICENSING_DATABASE
          value: TrLicenses
        - name: TRANACT_LICENSING_USERNAME
          value: superadmin
        - name: TRANACT_LICENSING_PASSWORD
          value: "zY8ebjr1eEbsnm83zB2g"
        - name: APPLICATION_HOST
          value: localhost:3000
        - name: GODADDY_MAIL_USERNAME 
          value: portal@scrap-dragon.com
        - name: GODADDY_MAIL_PASSWORD
          value: portal@dragon

  - name: nginx
    properties:
      image: tranact/licensing_nginx:production
      ports:
        - port: 80
        - port: 443
      #volumeMounts:
      #- name: sslfileshare
      #  mountPath: /var/www/app_name/ssl
      resources:
        requests:
          cpu: 0.25
          memoryInGB: 2
  #volumes:
  #  - name: sslfileshare
  #    azureFile:
  #      sharename: jpegsslfileshare
  #      storageAccountName: jpegsslstorage
  #      storageAccountKey: qn2QFGumE7kN0xd+5+AvFZKHC/OLGPj6kh/+FimJ+D7tjV55UymEkyMflFc/9/efIxeEq+L+eySsdlk/EC6fpw== 
 
  ipAddress:
    ports:
    - protocol: tcp
      port: '80'
    - protocol: tcp
      port: '443'
    type: Public
    dnsNameLabel: 'azureprodlicensing'
