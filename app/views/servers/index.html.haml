-@title= "Servers"
= render partial: 'shared/navbars/header_navbar'
.container-fluid
  .row
    = render partial: 'shared/navbars/side_bar_menu'
    %main.col-md-9.ms-sm-auto.col-lg-10.px-md-4
      .d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom
        %h1.h2 Servers
        .btn-toolbar.mb-2.mb-md-0
          .btn-group.me-2
            %button.btn.btn-sm.btn-outline-secondary{:type => "button"} Share
            %button.btn.btn-sm.btn-outline-secondary{:type => "button"} Export
          = link_to 'New', new_server_path, class: 'btn btn-primary btn-sm'

      .table-responsive
        %table.table.table-striped
          %thead
            %tr
              %th Name
              %th Account
              %th MAC
              %th
          %tbody
            - @servers.each do |server|
              - tranact_account = server.tranact_account
              %tr
                %td.highlightable= server.Name
                %td
                  - unless tranact_account.blank?
                    = link_to tranact_account.Name.truncate(20), tranact_account
                  - else
                    None
                %td.highlightable= server.MAC
                %td
                  = link_to 'Show', server, class: 'btn btn-sm btn-outline-secondary'
                  = link_to 'Edit', edit_server_path(server), class: 'btn btn-sm btn-primary'
                  = link_to 'Delete', server, :method => :delete, class: 'btn btn-sm btn-danger', :data => { :confirm => 'Are you sure you want to delete this server? It cannot be undone.' }
                  =# link_to 'Delete', '#', class: 'btn btn-sm btn-danger'
      = paginate @servers

:javascript
  $(document).ready(function() {
    var txt = $("#q").val()
    if (txt.length > 0) {
      $(".highlightable").each(function (i, v) {
        //The extra parentheses in new Regexp() will store the value found. The $1 in .replace() inserts the stored value so character cases will be consistent.
        v.innerHTML = v.innerText.replace(new RegExp('('+txt+')', 'ig'), "<mark>$1</mark>");
      });
    }
  });